Have a counting [[semaphore]] counting the elements in the buffer. If the buffer is written to, signal (increment), if the buffer is read, wait (decrement). This way, a buffer can only be read when something new is in the buffer.